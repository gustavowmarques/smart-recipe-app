{% extends "core/base.html" %}
{% load static %}
{% block title %}AI Recipe Ideas{% endblock %}

{% block content %}
<h2 class="mb-3">AI Recipe Ideas ({{ kind|title }})</h2>
<p class="text-muted">Pantry: {{ pantry|join:", " }}</p>

<div class="row g-4">
  {% for r in recipes %}
  <div class="col-12 col-md-6 col-lg-4">
    <div class="card h-100 shadow-sm">

      {% if r.image_url %}
        <img src="{{ r.image_url }}" class="card-img-top" alt="{{ r.title }}" style="height:200px;object-fit:cover;">
      {% else %}
        <img src="{% static 'img/recipe_placeholder.jpg' %}" class="card-img-top" alt="No image" style="height:200px;object-fit:cover;">
      {% endif %}

      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ r.title }}</h5>

        {% if r.tags %}
          <div class="mb-2">
            {% for t in r.tags %}
              <span class="badge text-bg-light border me-1">{{ t }}</span>
            {% endfor %}
          </div>
        {% endif %}

        {% if r.cook_time_minutes %}
          <div class="small text-muted mb-2">~ {{ r.cook_time_minutes }} min</div>
        {% endif %}

        {% if r.id %}
          <a href="{% url 'recipe_detail' recipe_id=r.id %}" class="btn btn-primary mt-auto">View Recipe</a>
        {% else %}
          <button class="btn btn-secondary mt-auto" disabled>View Recipe</button>
        {% endif %}

        {# Optional: this collapse has no toggle now; safe to remove if unused #}
        <div id="r{{ forloop.counter }}" class="collapse mt-3">
          <h6>Ingredients</h6>
          <ul class="small">
            {% for i in r.ingredients %}<li>{{ i }}</li>{% endfor %}
          </ul>

          <h6>Steps</h6>
          <ol class="small">
            {% for s in r.steps %}<li>{{ s }}</li>{% endfor %}
          </ol>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<a class="btn btn-secondary mt-4" href="{% url 'dashboard' %}">Back</a>
{% endblock %}
