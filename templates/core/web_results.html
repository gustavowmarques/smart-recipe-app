<!-- templates/core/web_results.html -->
{% extends "core/base.html" %}
{% block title %}Web Recipes{% endblock %}
{% block content %}
<h4>Web Recipes ({{ kind|title }})</h4>
<p class="text-muted">Based on your pantry: {{ pantry|join:", " }}</p>

<div class="row">
  {% for r in results %}
  <div class="col-md-6 col-lg-4">
    <div class="card mb-3 shadow-sm h-100">
      {% if r.image %}<img src="{{ r.image }}" class="card-img-top" alt="{{ r.label }}">{% endif %}
      <div class="card-body d-flex flex-column">
        <h6 class="card-title">{{ r.label }}</h6>
        <p class="small text-muted mb-2">
          {% if r.readyInMinutes %}‚è± {{ r.readyInMinutes }} min &nbsp;{% endif %}
          {% if r.servings %}üçΩ {{ r.servings }} servings{% endif %}
        </p>

        <p class="small mb-1">
          <strong>Matches:</strong>
          {% if r.usedIngredients and r.usedIngredients|length > 0 %}
            {% for u in r.usedIngredients %}
              <span class="badge bg-success-subtle text-success border">{{ u }}</span>
            {% endfor %}
          {% else %}
            <span class="badge bg-secondary">none</span>
          {% endif %}
        </p>
        {% if r.missedIngredients and r.missedIngredients|length > 0 %}
        <p class="small text-muted">
          <strong>Missing:</strong>
          {% for m in r.missedIngredients|slice:":3" %}
            <span class="badge bg-light text-dark border">{{ m }}</span>
          {% endfor %}
          {% if r.missedIngredients|length > 3 %}‚Ä¶{% endif %}
        </p>
        {% endif %}

        <div class="mt-auto">
          {% if r.url %}
            <a class="btn btn-sm btn-primary w-100" href="{{ r.url }}" target="_blank" rel="noopener">Open Recipe</a>
          {% else %}
            <span class="badge bg-secondary">No source URL</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<a class="btn btn-outline-secondary" href="{% url 'dashboard' %}">Back</a>
{% endblock %}
